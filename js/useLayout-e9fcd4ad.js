import{O as q,a as W,b as C,V as F,W as J,X as ee,Y as Z,j as z,Z as te,$ as ae,a0 as ne,S as U,c as se,u as le,g as Y,a1 as K,a2 as Q,a3 as j,a4 as oe,a5 as O,a6 as ie,a7 as re,o as ce,a8 as ue}from"./index-42c4f717.js";import{g as de,a as pe}from"./mgm2-76c9a70b.js";import{g as fe}from"./shoppingMall-5ac025db.js";import{g as ge}from"./website-15256f3d.js";import{O as _,r as D,aN as ve,e as c,W as me,P as Ee,w as L,X as he,aQ as Se,aO as X,A as be,_ as ye}from"./vendor-749afd36.js";const I=60*1e3,Me=2*I,Re=2*I,De=5*I,Te=5*I,Be=1*I,We=1*I,Ce=30*I,Ne=o=>{const a=q(),{t:s}=z(),t=W(),l=C(),{RankingEventEnabled:u,SiteMailEnabled:b}=_(t),p=he();let h=D(0),v,S;const f=D(!1),{isLogin:d,memberRankEligibilityStatus:w}=_(l),y=ve({route:"",path:c(()=>me().fullPath)});h=c(()=>l.unRead);const n=async()=>{try{const e=await te();l.setDepositApplying(e.Data)}catch(e){console.error(e)}},i=async()=>{try{const e=await ae();l.setWithdrawApplying(e.Data)}catch(e){console.error(e)}},r=()=>{const{pause:e}=Se(()=>{d.value&&l.isQualified?(n(),i()):e()},Me)},k=X("fetchDepositApplyStatus"),m=X("fetchWithdrawalApplyStatus");M(),P(),r(),t.setSupportEnabled(null),Ee(async()=>{const e=await ge();if(t.setSupportEnabled(e.Data.SupportEnabled),t.setSupportDisableMessage(e.Data.SupportDisableMessage),t.setRankingEventEnabled(e.Data.RankingEventEnabled),t.setRankingEventHintEnabled(e.Data.RankingEventHintEnabled),t.setReferralEnabled(e.Data.ReferralEnabled),t.setCouponBoxEnabled(e.Data.CouponBoxEnabled),t.setSignEventEnabled(e.Data.SignEventEnabled),t.setShoppingMallEnabled(e.Data.ShoppingMallEnabled),t.setVIPClubEnabled(e.Data.VIPClubEnabled),t.setLuckyWheelEnabled(e.Data.LuckyWheelEnabled),t.setAppEnabled(e.Data.AppEnabled),t.setAPKUrl(e.Data.APKUrl),t.setExternalAdSetting(e.Data.ExternalLinkEnabled,e.Data.ExternalName,e.Data.ExternalLink,e.Data.ExternalLinkOpenMode),k.on(n),m.on(i),d.value){try{Promise.all([x(),G(),V()])}catch(A){F(`layout: ${A}`)}g();const E=J();!l.fromApp&&!E&&l.logout()}else t.setMallSetting(null),t.resetHiddenElement()});const N={ReferralEnabled:"setShowReferralEnabled",BalanceEnabled:"setBalanceHistoryEnabled",BetRecordEnabled:"setBetHistoryEnabled"},g=async()=>{try{const e=await ee(),E=e.Data;if(e.ErrorCode===2e4){for(const A in E)if(E&&E[A]!==""){const $=N[A]||`set${A}`;t[$]&&t[$](E[A])}}else t.resetHiddenElement()}catch(e){console.log(e),t.resetHiddenElement()}};L(()=>d.value,async e=>{if(P(),r(),M(),t.setMallSetting(null),e)try{Promise.all([x(),G(),V()])}catch(E){F(`layout: ${E}`)}}),L(()=>h.value,(e,E)=>{e>E&&B()}),L(()=>w.value,()=>{re(o)},{deep:!0});async function T(){try{const[e]=await Promise.all([ne()]);return l.setUnRead(e.Count),Promise.resolve(!0)}catch(e){return Promise.reject(e)}}function M(){d.value&&l.isQualified?S=setInterval(()=>{T()},Re):(S&&window.clearInterval(S),S=null)}function P(){d.value&&u.value?v=setInterval(()=>{Z()},De):(v&&window.clearInterval(v),v=null)}const x=async()=>{const e=await de();e.ErrorCode===2e4?t.setMgmSetting(e.Data):t.setMgmSettingIsEnable(!1)},G=async()=>{const e=await pe();e.ErrorCode===2e4&&t.setNextBonusInfo(e.Data.NextBonusInfo)},V=async()=>{const e=await fe();e.ErrorCode===2e4&&t.setMallSetting(e.Data)},B=()=>{let e=s("Shared.HaveUnread");o&&(U.THEME_LAYOUT_CODE==="b02"&&(e=s("Shared.HaveUnreadBreakWord")),d.value&&b.value&&h.value!==0&&l.isQualified&&!l.fromApp&&!l.isWeakPassword&&window.location.pathname.indexOf("/SiteMail")==-1&&a.show({component:o,bind:{bodyText:e,modalType:"alert",modalIconType:"none",showCancelBtn:!1},on:{confirm:E=>{p.push("/SiteMail"),E()}}}))},R=p.currentRoute,H=()=>{R.value.name===void 0?f.value=!1:R.value.meta.layout!==void 0&&typeof R.value.meta.layout=="boolean"?(y.route=R.value.fullPath,f.value=R.value.meta.layout):f.value=!0};return H(),R.value.name&&f.value&&B(),L(()=>R.value.params,()=>{H(),R.value.name&&f.value&&B()}),{router:p,userStore:l,isLogin:d,layout:f,currentWindow:y,showUnReadMail:B,setLayout:H,checkHideElement:g}},He=()=>{const o=W(),a=C(),s=se(),t=c(()=>o.contact.GuestChatState),l=c(()=>o.contact.GuestTelegramLink),u=c(()=>a.isLogin),b=c(()=>a.isApplyWithdraw),p=c(()=>a.isApplyDeposit),h=c(()=>a.isRegisterMode),v=c(()=>a.account),S=D(s.$state),{GuestChatState:f}=le(),d=()=>{s.setRegisterModalVisible(!1),s.setLoginModalVisible(!0),s.setGuestMailVisible(!1)},w=async g=>{s.setLoginModalVisible(!g),s.setRegisterModalVisible(g),a.setIsRegisterMode(g)},y=async g=>{if(t.value==f.Telegram&&l.value!=""){ce(l.value,{target:"_blank"});return}s.setLoginModalVisible(!g),s.setRegisterModalVisible(!g),s.setGuestMailVisible(g)},n=ye(async()=>{await a.logout(),await o.setMgmSettingIsEnable(!1),o.resetHiddenElement()},500),i=async()=>{let g=0,T=0;try{const M=await ue();M.ErrorCode===2e4&&(g=M.Data.UnRead,T=M.Data.UnReply)}catch(M){console.error("fetchServiceMailStatus failed",M)}return{unRead:g,unReply:T}},r=c(()=>Y(a.balance)),k=c(()=>Y(a.pointAmount)),m=c(()=>a.unRead),N=c(()=>a.availableCoupon);return{balance:r,point:k,isApplyWithdraw:b,isApplyDeposit:p,isLogin:u,isRegisterMode:h,showModal:S,userStore:a,haveAccount:v,unRead:m,availableCoupon:N,changeModal:d,changeRegisterModal:w,changeGuestMailModal:y,handleLogout:n,fetchServiceMailStatus:i}},Oe=()=>{const o=c(()=>W().getGameNav),a=D([]),s=K.isMobile?Q.subNavList:j.subNavList,t=K.isMobile?Q.gameMenu:j.gameMenu,l=Object.keys(t),u=D(["01","02","03","08","09","14","07","11","12","10","04","05","06","13"]),b={title:"Shared.About_Us",links:[{name:"Shared.About_Us",url:"/Notice/1"}]},p={title:"Shared.HeaderNotice",links:[]},h={title:"Shared.HeaderBetRule",links:[]},v={title:"Shared.Site_Map",links:[]};S(o.value),L(()=>o.value,()=>{S(o.value)});function S(f){const d=[];p.links=[],h.links=[],v.links=[];const w=U?.THEME_LAYOUT_CODE,y=s.filter(n=>n.name==="betRule").length>0;f.forEach(n=>{const i=n.NavigationKindName;let r;function k(m){d.push.apply(d,m.logo),y?h.links.push({name:m.txt,url:"/BetRule"}):p.links.push({name:m.txt,url:`/Notice/${m.noticeNum}`}),v.links.push({name:m.txt,url:`/Lobby/${m.url}`})}i==="Sport"?n.NavigationSortList.forEach(m=>{r=t[m.LangKey],r&&k(r)}):U.THEME_LAYOUT_CODE==="a02"?i!=="IdnPoker"&&i!=="VSport"&&(r=t[i],k(r)):(r=t[i],k(r))}),a.value=[b,y?h:p,v],w==="b02"?u.value=["01","08","02","03","09","14","07","11","12","10","04","05","06","13"]:u.value=["01","02","03","08","09","14","07","11","12","10","04","05","06","13"],u.value=u.value.filter(n=>d.indexOf(n)>=0)}return{gameNav:l,gameMenu:t,footerItems:a,logos:u}},Ue=o=>{const a=D(!1),s=D(""),t=D(!1),l=c(()=>p.isLogin),u=q(),{t:b}=z(),p=C(),h=W(),{RankingEventEnabled:v}=_(h);async function S(){if(!l.value)return;if(a.value||s.value!=="")return null;a.value=!0,t.value=!0;const n=await oe();if(n.ErrorCode!==2e4){f(n.RemainSecond),u.show({component:o,bind:{bodyText:b("Shared.Error_Occurred")}});return}f(n.RemainSecond),d()}function f(n){if(n&&n>0){let i=parseInt(n);s.value="("+i+")";const r=setInterval(async function(){s.value="("+i+")",i--,i<=0&&(clearInterval(r),s.value="")},1e3)}}function d(){const n=Math.floor(Math.random()*3)+3,i=Math.floor(Math.random()*3)+1;be(async()=>{const r=await O();v.value&&Z(),p.setBalance(r.Data.Balance),a.value=!1,t.value=!1},1e3*n*i)}async function w(){t.value=!0;const n=await O();p.setBalance(n.Data.Balance),t.value=!1}function y(){setInterval(async function(){const n=await O();p.setBalance(n.Data.Balance)},5e3)}return{updatingBalance:a,refreshCountdown:s,refreshWallet:S,aniLoading:t,getMyWallet:w,autoRefreshWallet:y}},_e=()=>{const o=C(),a=c(()=>o.isLogin);let s;const t=()=>{if(L(()=>a.value,()=>{a.value?l():u()}),!a.value){u();return}l()},l=()=>{s=setInterval(async function(){const b=await ie();o.setBalance(b.Balance)},1e4)},u=()=>{clearInterval(s)};return{autoRefreshGameWallet:t,clearRefreshGameWallet:u}};export{Ue as a,Oe as b,Ne as c,_e as d,We as e,Ce as f,Be as i,Te as l,He as u};
